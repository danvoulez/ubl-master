<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>UBL Audit</title>
  <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  <style>
    :root {
      --bg: #0c1420;
      --surface: #152237;
      --text: #e7effb;
      --muted: #9db1cc;
      --line: #314664;
      --brand: #53b3ff;
      --warn: #ff9a3c;
    }
    * { box-sizing: border-box; }
    body { margin:0; padding:1.2rem; background:#0c1420; color:var(--text); font-family:"JetBrains Mono","SFMono-Regular",Menlo,monospace; }
    a { color: var(--brand); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .top { display:flex; justify-content:space-between; align-items:center; gap:1rem; flex-wrap:wrap; margin-bottom:1rem; }
    .tabs { display:inline-flex; padding:0.2rem; border:1px solid var(--line); border-radius:999px; background:#0f1b2c; gap:0.2rem; }
    .tab { padding:0.35rem 0.85rem; border-radius:999px; color:var(--muted); }
    .tab.active { background:#1a2d48; color:var(--text); border:1px solid #4f6b92; }
    .row { display:flex; gap:0.8rem; flex-wrap:wrap; align-items:center; }
    .box { border:1px solid var(--line); border-radius:10px; padding:0.9rem; margin-top:1rem; background:var(--surface); overflow-x:auto; }
    .llm-box { border:2px solid var(--warn); background:linear-gradient(135deg,#2a1f16,#1f2530 45%,#1a2d48); }
    input, button { font-family:inherit; padding:0.4rem 0.55rem; border-radius:8px; border:1px solid #47648c; background:#0f1f35; color:var(--text); }
  </style>
</head>
<body>
  <div class="top">
    <div class="row">
      <h1 style="margin:0; font-size:1.3rem;">UBL Audit / {{ kind }}</h1>
      <nav class="tabs" aria-label="Modo">
        <a class="tab" href="/console?tab=live&world={{ world }}">Live</a>
        <a class="tab" href="/console?tab=stats&world={{ world }}">Estatisticas</a>
      </nav>
    </div>
    <div class="row">
      <a href="/registry?world={{ world }}">Registry</a>
      <a href="/metrics">Metrics</a>
    </div>
  </div>

  <div class="row" style="margin-bottom:0.4rem;">
    <a href="/audit/reports?world={{ world }}">Reports</a>
    <a href="/audit/snapshots?world={{ world }}">Snapshots</a>
    <a href="/audit/compactions?world={{ world }}">Compactions</a>
  </div>

  <form id="audit-filters" class="row">
    <input type="hidden" name="kind" value="{{ kind }}">
    <label for="world">world</label>
    <input id="world" name="world" value="{{ world }}">
    <button
      type="button"
      hx-get="/audit/_table"
      hx-include="#audit-filters"
      hx-target="#audit-table"
      hx-swap="innerHTML">Refresh</button>
  </form>

  <div id="llm-audit"
       class="box llm-box"
       hx-get="/ui/_llm?page=audit&kind={{ kind }}"
       hx-include="#audit-filters"
       hx-trigger="load delay:2s, every 45s"
       hx-swap="innerHTML">Analisando com LLM... (loading)</div>

  <div id="audit-table"
       class="box"
       hx-get="/audit/_table"
       hx-include="#audit-filters"
       hx-trigger="load, every 10s"
       hx-swap="innerHTML">Loading audit rows...</div>
</body>
</html>
